graph TD
    A[Start Experiment] --> B{Model Exists?}
    B -- Yes --> C[Load Pre-trained Model]
    B -- No --> D[Initialize SiameseNetwork]
    D --> E[Prepare Dataset]
    E --> F[Create DataLoader]
    F --> G[Define Optimizer Adam and Loss Function ContrastiveLoss]
    
    G --> H[Training Loop]
    H --> I[Calculate Positive Pairs]
    I --> J[Calculate Negative Pairs]
    J --> K[Merge Loss]
    K --> L[Backpropagation]
    L --> M[Update Parameters]
    M --> H
    
    H --> N{Completed 20 Epochs?}
    N -- No --> H
    N -- Yes --> O[Save Model]
    
    O --> P[Evaluation Preparation]
    C --> P
    P --> Q[Load Test Dataset]
    Q --> R[Reorganize Captcha Data]
    R --> S[Calculate Feature Vector Distances]
    S --> T[Calculate Accuracy]
    T --> U[Output Single Character/Full Captcha Accuracy]
    U --> V[End]

    style A fill:#4CAF50,stroke:#388E3C,color:black
    style B fill:#FFC107,stroke:#FFA000,color:black
    style C fill:#2196F3,stroke:#1976D2,color:white
    style D fill:#2196F3,stroke:#1976D2,color:white
    style E fill:#9C27B0,stroke:#7B1FA2,color:white
    style F fill:#9C27B0,stroke:#7B1FA2,color:white
    style G fill:#9C27B0,stroke:#7B1FA2,color:white
    style H fill:#009688,stroke:#00796B,color:white
    style M fill:#009688,stroke:#00796B,color:white
    style N fill:#009688,stroke:#00796B,color:white
    style I fill:#FF5722,stroke:#E64A19,color:white
    style J fill:#FF5722,stroke:#E64A19,color:white
    style K fill:#FF5722,stroke:#E64A19,color:white
    style L fill:#FF5722,stroke:#E64A19,color:white
    style O fill:#3F51B5,stroke:#303F9F,color:white
    style P fill:#3F51B5,stroke:#303F9F,color:white
    style Q fill:#3F51B5,stroke:#303F9F,color:white
    style R fill:#3F51B5,stroke:#303F9F,color:white
    style S fill:#3F51B5,stroke:#303F9F,color:white
    style T fill:#3F51B5,stroke:#303F9F,color:white
    style U fill:#3F51B5,stroke:#303F9F,color:white
    style V fill:#F44336,stroke:#D32F2F,color:white